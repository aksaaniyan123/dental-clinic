(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"3DW5":function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return r});var a=/(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?/gim,c=function extractPhoneNumbers(e){return e?e.match(a):null},r=function formatPhoneForDisplay(e){if(!e)return"";if(e.length<10)return e;var t="".concat(e).replace(/\D/g,"").substr(-10).match(/^(\d{3})(\d{3})(\d{4})$/);return t?"+1-".concat(t[1],"-").concat(t[2],"-").concat(t[3]):e}},"3y+j":function(e,t,n){},"7fJ7":function(e,t,n){"use strict";n.r(t);var a=n("mj2O"),c=n.n(a),r=n("7SM1"),o=n("s8DI"),i=n("QtlZ"),s=n("Wjfv"),u=n("7oto"),l=function UseRemoveActiveCampaign(){Object(u.c)({topic:"CONDUCTOR:remove-active-campaign",handler:function handler(e){i.a.dispatch(Object(s.a)())}})},d=n("nfbA"),b=n("mfas"),f=function UseStateSnapShot(){return Object(u.c)({topic:"CONDUCTOR:request-state-from-controller",handler:function handler(e){var t=e.data,n=i.a.getState();Object(u.a)({topic:"".concat(t.name,":state-snap-shot"),message:{state:Object(d.a)(Object(d.a)({},Object(b.a)(["session"],n)),{},{session:Object(b.a)(["sockets"],n.session)})}})}}),i.a},p=n("My8U"),h=n("nJ3u"),O=n("O94r"),g=n.n(O),v=n("nQD+"),j=n("ab+K"),m=n("7oh4"),_=n("nedb"),w=n("LVcX"),k=n("ERkP"),C=n.n(k),y=function useIsBotMessage(e){return Object(k.useMemo)(function(){return Object(w.a)(!1,["attributes","isBot"],e)},[e])},E=n("z24s"),I=n("58kB"),S=n("LaGA"),x=function useResizeObserver(){var e=Object(k.useState)(),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(k.useState)(null),r=Object(o.a)(c,2),i=r[0],s=r[1],u=Object(k.useRef)(null),l=Object(k.useCallback)(function(){return u.current&&u.current.disconnect()},[]),d=Object(k.useCallback)(function(){i&&(u.current=new S.a(function(){return a(function getRectForRef(e){return e&&e.getBoundingClientRect()}(i))}),u.current.observe(i))},[i]);return Object(k.useLayoutEffect)(function(){return d(),function(){return l()}},[l,d]),[n,s]},A=n("lE29"),T=n("da4L"),R=n("i9gz"),M=n("DboL"),P=n("uDfI"),N=function useUnreadMessagesForActiveConversation(){var e=Object(P.c)(function(e){return e.conversations}).activeConversation,t=Object(P.c)(function(t){return Object(w.a)({},["conversations","messages",e],t)}),n=Object(P.c)(function(t){return Object(w.a)([],["conversations","unreadAgentMessages",e],t)});return Object(k.useMemo)(function(){if(Object(R.a)(t))return[];var e=Object(T.n)(Object(M.a)(t));return e.filter(function(e){return function messageHasBody(e){return!!e.body&&!!e.body.length}(e)&&function messageIsNotRatingPrompt(e){return!Object(T.e)(e,"ratingPrompt")}(e)&&function messageIsUnread(e){return n.includes(e.id)}(e)})},[t,n])},L=n("LwEI"),D=n("SsZN"),U=n("vjCh"),B=n("qixE"),V=n("xwTo"),F=n("X9/c"),H=n("g6eD"),$=n("RhEL"),W=n("oPI6"),G=n("vTYT"),z=n("y0on"),q=(n("pUpc"),function MessagePreview(){var e=x(),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(P.b)(),r=Object(k.useState)(null),i=Object(o.a)(r,2),s=i[0],u=i[1],l=Object(k.useRef)(null),d=Object(E.a)(l),b=Object(P.c)(function(e){return e.conversations}).activeConversation,f=N(),p=Object(_.a)(),O=Object(A.a)(),S=Object(P.c)(function(e){return e.view.chatOpen}),M=Object(L.a)(),q=Object(I.a)(s?s.authorId:null),J=Object(k.useMemo)(function(){return!(!s||!s.body||S)},[s,S]);Object(k.useEffect)(function setLatestMessageFromConvo(){if(Object(R.a)(f))u(null);else{var e=f.pop()||{};s&&Object($.a)(e.id,s.id)||u(Object(T.q)(e,100))}},[f]),Object(k.useLayoutEffect)(function updateFrameSize(){if(J){var e=n?n.width:0,t=n?n.height:0,a=e+m.b+40,c=t+36;Object(F.c)(c,a)}},[n,J]);var Y=y(s);if(!J)return null;var X=function dismiss(){s&&(Object(B.c)(b),u({}),Object(F.b)(),Q())},Q=function dismissPlaybookIfNotInteracted(){if(!Object(V.g)()){var e=Object(w.a)(null,["attributes","playbookId"],p);Object(D.o)(s),Object(U.j)(p.id,e)}},K=Object(T.c)(s),Z=Object(z.a)(q.recipient.name,K);return C.a.createElement(C.a.Fragment,null,C.a.createElement("style",null,"\n          .drift-widget-message-preview .drift-widget-message-preview-text p.keyboard-focused {\n            ".concat(Object(h.c)(O.activeColor),"\n          }\n        ")),C.a.createElement("div",{className:"drift-widget-message-preview-wrapper",key:"".concat(s.id,"-preview-box")},C.a.createElement(W.b,{message:Z,"aria-live":"polite",clearOnUnmount:!0}),C.a.createElement("div",{className:"drift-widget-message-preview drift-widget-message-preview--align-".concat(M)},M===G.a.RIGHT&&C.a.createElement(j.a,{onClick:X}),C.a.createElement(v.a,{ref:l,onClick:function openChat(){if(Object(F.b)(),Y){var e=Object(w.a)(null,["attributes","playbookId"],p);Object(D.n)(s),Object(U.j)(p.id,e)}c(Object(H.d)({chatOpen:!0}))},className:"drift-widget-message-preview-text drift-widget-message-preview-text--align-".concat(M),"aria-label":"".concat(Z?Z+" - ":"","Click to open chat")},C.a.createElement("p",{ref:a,className:g()({"keyboard-focused":d})},K)),M===G.a.LEFT&&C.a.createElement(j.a,{onClick:X}))))}),J=n("+Kbs"),Y=n("yEsl"),X=n("hSLT"),Q=n("fL0f"),K=n("6wvX"),Z=n("tLIi"),ee=n("o3t1"),te=function useThemeIcon(){var e=Object(P.c)(function(e){return e.embed.configuration}).theme,t=e.iconStyle,n=e.iconUrl,a=e.foregroundColor,c={SOLID1:C.a.createElement(J.h,{fill:"#".concat(a)}),SOLID2:C.a.createElement(J.g,{fill:"#".concat(a)}),OUTLINE1:C.a.createElement(J.e,{fill:"#".concat(a)}),OUTLINE2:C.a.createElement(J.f,{fill:"#".concat(a)}),BOLT:J.c};return{customIcon:n?{backgroundImage:"url(".concat(n,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{},hasCustomIcon:!!n,Icon:c[t]||null}},ne=n("8saY"),ae=function useWidgetIconShape(){return Object(P.c)(function(e){return e.embed.configuration.theme.widgetIconShape})||ne.b.SQUARE},ce=n("2XY6"),re=n("0B8E"),oe=n("MFhO"),ie=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(e=Object(w.a)(!1,["embed","configuration","theme","soundNotificationEnabled"],i.a.getState()),t=i.a.getState().view.chatOpen,!e){n.next=5;break}return n.next=5,Object(u.a)({topic:"play-host-notification",message:{chatOpen:t}});case 5:case"end":return n.stop()}},_callee)}));return function playSoundNotification(){return e.apply(this,arguments)}}(),se=n("rTkt"),ue=(n("3y+j"),"SENDER"),le="MEGAPHONE",de="THEME_ICON",be=function WidgetIcon(){var e=Object(k.useRef)(null),t=Object(E.a)(e),n=Object(ee.a)(),a=n.hoverProps,c=n.isHovered,r=Object(P.b)(),i=Object(P.c)(function(e){return e.view.chatOpen}),s=Object(P.c)(function(e){return e.session.gdpr}),l=Object(P.c)(ce.c),b=Object(P.c)(function(e){return!!e.conversations.activeConversation}),f=Object(L.a)(),p=Object(_.a)(),O=Object(P.c)(function(e){return Object(w.a)(!1,["embed","configuration","theme"],e)}).unreadBadgeEnabled,v=N(),j=Object(P.c)(function(e){return e.view.isChatTakeover}),m=Object(Z.a)(),S=y(m),x=Object(A.a)(),T=x.activeColor,R=x.backgroundStyles,M=x.widgetSecondaryColor,B=Object(k.useMemo)(function(){return c?Object(se.c)(R.background,-35):R.background},[c,R]),V=te(),$=V.Icon,W=V.customIcon,G=V.hasCustomIcon,z=Object(X.a)(),q=z.senderId,ne=z.type,be=q||Object(w.a)(void 0,["authorId"],m),fe=Object(I.a)(be).recipient,pe=v?Object(re.a)(v).length:0,he=ne===oe.a.SLIDER,Oe=be&&(he||pe>0),ge=Object(Q.a)(["titleNotificationEnabled"]),ve=Object(o.a)(ge,1)[0],je=void 0!==ve&&ve,me=Object(k.useMemo)(function(){return Oe?ue:he&&!be?le:de},[be,he,Oe]),_e=Object(K.a)(),we=ae();Object(k.useEffect)(function(){je&&Object(u.a)({topic:"page-notification-update",message:{totalUnreadMessages:pe}})},[pe,je]);Object(k.useEffect)(function(){l?Object(F.d)():Object(F.a)()},[l]),Object(k.useEffect)(function(){Object(u.a)({topic:"toggle-widget-controller",message:{isChatTakeover:j,open:i,hasActiveConversation:b&&s.hasConsent}})},[i,s,b,j]),Object(k.useEffect)(function(){v&&v.length>0&&ie()},[v]);var ke=Object(k.useMemo)(function(){return Oe&&!i?null:{background:"".concat(B)}},[Oe,i,B]),Ce=Object(k.useMemo)(function(){return!G||Oe||i?null:c?Object(d.a)({opacity:.65},W):W},[W,Oe,i,G,c]),ye=Object(k.useMemo)(function(){if(i)return fe.name?"Click to close chat with ".concat(fe.name):"Click to close chat";var e=fe.name?"Click to open chat with ".concat(fe.name):"Click to open chat";return O&&pe>0?"".concat(e," - Unread messages: ").concat(pe):e},[i,O,fe.name,pe]);return C.a.createElement(C.a.Fragment,null,C.a.createElement("style",null,"\n          .drift-widget-controller.keyboard-focused:before {\n            ".concat(Object(h.a)(T,64),"\n          }\n        ")),l&&C.a.createElement("button",Object.assign({className:g()("drift-widget-controller drift-widget-controller--align-".concat(f),[we],{"drift-widget-controller--closed":!_e&&i,"drift-widget-controller--custom-icon":G,"drift-widget-controller--avatar":Oe,"drift-widget-controller--hide":j,"keyboard-focused":t}),onClick:function onToggleChat(){if(!i&&pe>0&&S){var e=Object(w.a)(null,["attributes","playbookId"],p);Object(U.j)(p.id,e),Object(D.n)(m)}!function toggle(e){he?Object(u.a)({topic:"slider:showDetails",message:{}}):r(Object(H.d)({chatOpen:e})),e&&Object(u.a)({topic:"reset-controller-size"})}(!i)},style:ke},a,{"aria-label":ye,ref:e}),C.a.createElement("div",{className:g()("drift-widget-controller-icon",[we]),style:Ce},C.a.createElement("div",{className:"drift-controller-icon--active"},me===le&&C.a.createElement(J.n,{fill:M}),me===ue&&C.a.createElement(Y.a,{className:g()([we],"drift-controller-icon--avatar"),avatarClassName:g()([we],"drift-controller-icon--avatar-avatar"),id:be}),me===de&&!G&&$),C.a.createElement("div",{className:"drift-controller-icon--close",style:{backgroundColor:M}})),O&&pe>0&&C.a.createElement("div",{className:"drift-controller-icon-unread"},Math.min(pe,99))))},fe=n("qATS"),pe=n("Sn8X"),he=function ControllerLayout(){return Object(pe.a)(),C.a.createElement("main",{role:"main","aria-label":"Widget Icon"},C.a.createElement(W.a,null,C.a.createElement(q,null),C.a.createElement(be,null)))},Oe=function(){var e=Object(fe.a)();return C.a.createElement(C.a.Fragment,null,e&&C.a.createElement(he,null))},ge=n("WwEg"),ve=n("OE2q"),je=n("LqZ+"),me=n("SHZQ"),_e=n("La++"),we=n("K7i0"),ke=n("Hvhg"),Ce=n("qwiD"),ye=n("JBtm"),Ee=n.n(ye),Ie=n("VYE+"),Se=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return e=Object(ke.j)(i.a.getState()),n.next=3,Object(Ie.e)({pardotId:e});case 3:t=n.sent,i.a.dispatch(Object(Ce.r)(t));case 5:case"end":return n.stop()}},_callee)}));return function stashIntegrationCookies(){return e.apply(this,arguments)}}(),xe=function resolveCookieDomain(){var e=Object(ke.f)(i.a.getState(),"cookieDomains",[]),t=e?e.find(function(e){return function matchesCookieDomain(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Ee.a.parseUrl(document.referrer).url;return(void 0===t?"":t).includes(e)}(e)}):null,n=t?".".concat(t):null;n&&i.a.dispatch(Object(Ce.j)({cookieDomain:n}))},Ae=n("Cpup"),Te=function receiveEmbedConfiguration(e){return Object(Ae.a)({type:"RECEIVE_EMBED_CONFIGURATION",payload:e})},Re=n("SFoa"),Me=n("PCkZ"),Pe=n("TDUE"),Ne=n("Gxm1"),Le=n("BAMi"),De=n("FAmh"),Ue=n("4Vr+"),Be=n("yzXs"),Ve=n("42TE"),Fe=n("gG69"),He=n("0lfv"),$e=function hasGate(e){return Object(w.a)(!1,["embed","configuration","gates",e],i.a.getState())},We=n("4c+F"),Ge=Object(Ue.a)(Object(Be.a)(Ve.a,He.m)),ze=function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a,r,o,s,u,l,d,b;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.formData,n=e.campaignId,$e("has_form_submission_fast_lane")&&n){c.next=3;break}return c.abrupt("return",{success:!1});case 3:if(t=t?Ge(t):null,!Object(He.m)(t)){c.next=7;break}return Object(We.c)("Sent Empty Form Data",{campaignId:n},!0),c.abrupt("return",{success:!1});case 7:return a=i.a.getState(),r=a.embed,o=r.id,s=Object(De.b)(),c.prev=10,c.next=13,Object(me.h)({embedId:o,mappingId:n,campaignIds:[n],formData:t,clientSideContext:s});case 13:if(u=c.sent,l=u.data,Object(He.m)(l.routingEvaluationResults)){c.next=20;break}return c.next=18,Object(Le.c)(l.routingEvaluationResults);case 18:d=c.sent,i.a.dispatch(Object(we.r)(d));case 20:if(!(b=!Object(He.m)(l.campaignTargetingResults)&&l.campaignTargetingResults[0].evaluationMatchOutcome===Fe.a.MATCH)){c.next=24;break}return c.next=24,Object(Le.a)({conditions:l.campaignTargetingResults});case 24:return c.abrupt("return",{success:!0,campaignMatched:b});case 27:c.prev=27,c.t0=c.catch(10),Object(He.n)({data:[c.t0],type:"warn"});case 30:return c.abrupt("return",{success:!1});case 31:case"end":return c.stop()}},_callee,null,[[10,27]])}));return function collectAndQualify(t){return e.apply(this,arguments)}}(),qe=n("6BAR");var Je,Ye=n("YvIt"),Xe=n("A5mO"),Qe=n("Nlet"),Ke=n("t8ds"),Ze=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t,n,a,r,o,s,l,d,b;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(u.a)({topic:"access-host-window",message:{key:"location"}});case 2:return e=c.sent,t=e.data,n=void 0===t?{}:t,c.next=7,Ke.a.get("visitCounts");case 7:return a=c.sent,r=a.data,c.next=11,Ke.b.get(Ye.b);case 11:o=c.sent,s=o.data,l=r||{},d=function getSessionCount(e){return e.lastSessionId?e.lastSessionId!==s?e.total+1:e.total:1},b=Object(qe.a)(l,function(e){var t=Xe.a.now().epoch;e.total=d(e),e.daysSinceLastVisit=Xe.a.now().since(e.lastVisit||Xe.a.now()).diff.days,e.lastVisit=t,e.firstVisit=e.firstVisit||t,e.lastSessionId=s,e[n.pathname]=(e[n.pathname]||0)+1;var a=Object(Xe.a)(l.lastVisit).diff(t,"minute");(!l.currentSessionStartedAt||a>30)&&(e.currentSessionStartedAt=t,Ke.a.removeItem(Ye.a))}),Ke.a.set("visitCounts",b),i.a.dispatch(Object(Ce.v)(b));case 18:case"end":return c.stop()}},_callee)}));return function countSiteVisit(){return e.apply(this,arguments)}}(),et=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n;return c.a.wrap(function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,tt();case 2:t=a.sent,n={url:Object(w.a)("",["page","href"],t),referrer:Object(w.a)("",["page","referrer"],t),title:Object(w.a)("",["page","title"],t),pageName:e||""},Object(je.b)(n);case 5:case"end":return a.stop()}},_callee2)}));return function trackPageLoadEvent(t){return e.apply(this,arguments)}}(),tt=function(){var e=Object(r.a)(c.a.mark(function _callee3(){var e;return c.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Qe.b)();case 2:return e=t.sent,i.a.dispatch(Object(Ce.i)(e)),t.abrupt("return",e);case 5:case"end":return t.stop()}},_callee3)}));return function hydrateWindowContext(){return e.apply(this,arguments)}}(),nt=n("pqMu"),at=n("LelF"),ct=n("HPUV"),rt=n("uIJS"),ot=n("wQh9"),it=function(){function SyncCallbackRunner(){Object(rt.a)(this,SyncCallbackRunner),this._running=!1,this._callbacks=[]}return Object(ot.a)(SyncCallbackRunner,[{key:"execute",value:function execute(e){this._callbacks.push(e),this.run()}},{key:"run",value:function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(!this._running&&0!==this._callbacks.length){n.next=2;break}return n.abrupt("return");case 2:this._running=!0;case 3:if(!(this._callbacks.length>0)){n.next=11;break}if(e=this._callbacks.shift(),!(t=e())||!t.then){n.next=9;break}return n.next=9,t;case 9:n.next=3;break;case 11:this._running=!1;case 12:case"end":return n.stop()}},_callee,this)}));return function run(){return e.apply(this,arguments)}}()}]),SyncCallbackRunner}(),st=n("HSQL"),ut=n("hm8b"),lt=n("3kqR"),dt=Object.freeze({welcomeMessage:"welcomeMessage",awayMessage:"awayMessage",emailCaptureMessage:"emailCaptureMessage",thankYouMessage:"confirmationMessage"}),bt=function apiWarning(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).warn.apply(e,["Drift API -"].concat(n))},ft=function apiError(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).error.apply(e,["Drift API -"].concat(n))},pt=n("F8vJ"),ht=function areAttributesValid(e,t,n,a){if(Object(ut.a)(a))return n;if("function"!==typeof a&&Object(nt.a)(Object,a)){for(var c=0,r=Object.keys(a);c<r.length;c++){var o=r[c],i=a[o];if(Object(ut.a)(i))return!0;if(!Object(nt.a)(Number,i)&&!Object(nt.a)(String,i)&&!Object(nt.a)(Boolean,i))return ft("".concat(e,'(...) "').concat(o,'" in ').concat(t," must be number, string, or boolean but instead we got ").concat(typeof i,".")),!1;if("email"===o&&(!Object(nt.a)(String,i)||!Object(pt.a)(i)))return ft("".concat(e,"(...) email in ").concat(t," is invalid:"),i),!1}return!0}return!1},Ot=function param(e,t,n){return{name:e,type:t,optional:n}},gt={config:[Ot("options",Object)],collectFormData:[Ot("data",Object,!0),Ot("options",Object,!0)],debug:[Ot("namespace",String,!0)],goToConversation:[Ot("Conversation ID",Number)],goToNewConversation:[Ot("Message",String)],identify:[Ot("User ID",String),Ot("attributes",ht,!0),Ot("options",Object,!0)],off:[Ot("Event name",String),Ot("handler",Function)],on:[Ot("Event name",String),Ot("handler",Function)],page:[Ot("Page name",String,!0)],setUserAttributes:[Ot("attributes",ht)],setUserJwt:[Ot("User JWT",String)],scheduleMeeting:[Ot("Agent ID",Number),Ot("options",Object,!0)],showAwayMessage:[Ot("Message",String,!0)],showWelcomeMessage:[Ot("Message",String,!0)],startInteraction:[Ot("params",function areStartInteractionParamsValid(e,t,n,a){return Object(ut.a)(a)&&!n||!Object(nt.a)(Object,a)?(ft("".concat(e,"({ ... }) must be called with ").concat(t," { interactionId: number, goToConversation: boolean } (goToConversation is optional.)")),!1):a.interactionId&&!Object(ut.a)(a.interactionId)&&Object(nt.a)(Number,a.interactionId)?!(a.goToConversation&&!Object(nt.a)(Boolean,a.goToConversation))||(ft("".concat(e,'({ ... }) "goToConversation" parameter should be boolean but we got ').concat(typeof a.goToConversation,".")),!1):(ft("".concat(e,"({ ... }) requires ").concat(t,' object with numeric "interactionId" but we got ').concat(typeof a.interactionId,".")),!1)})],toggleHoursAndTargeting:[Ot("enabled",Boolean)],track:[Ot("Event name",String),Ot("attributes",ht,!0)]},vt=function getTypeName(e){return e===String||Object(nt.a)(String,e)?"string":e===Boolean||Object(nt.a)(Boolean,e)?"boolean":e===Number||Object(nt.a)(Number,e)?"number":e===Object||Object(nt.a)(Object,e)?"object":e===Function||Object(nt.a)(Function,e)?"function":Object(ut.a)(e)?"null":"unknown"},jt=function validateMethod(e,t){return gt[e]?function areArgsValid(e,t,n){var a=t.length,c=n.filter(function(e){return!e.optional}).length;return n.reduce(function(n,r,o){var i=r.name,s=r.type,u=r.optional,l=void 0!==u&&u;if(o>=a)return l||ft("Invalid ".concat(e,"(...) call! It requires ").concat(c," argument(s) and it's missing ").concat(i," ").concat(vt(s),".")),n&&l&&a>=c;var d=t[o],b=!1;return l&&Object(ut.a)(d)?b=!0:s===Function||s===Object||s===String||s===Number||s===Boolean?(b="function"===typeof d?s===Function:Object(nt.a)(s,d))||ft("Invalid ".concat(e,"(...) call! ").concat(i," (arg ").concat(o,") should be ").concat(vt(s)," instead of ").concat(vt(d),".")):b=s(e,i,l,d),n&&b},!0)}(e,t,gt[e]):(!Object(ut.a)(t)&&Object(nt.a)(Array,t)&&!!t.length&&bt("".concat(e,"() should ideally be called without arguments.")),!0)},mt=function debouncedAPIMethod(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return Object(He.d)(e,t,!0)},_t=function(){var e=Object(r.a)(c.a.mark(function _callee(){return c.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return Ct(),e.next=3,Object(Ie.b)(at.c);case 3:Object(u.a)({topic:"reload-all-frames",message:{}});case 4:case"end":return e.stop()}},_callee)}));return function reset(){return e.apply(this,arguments)}}(),wt=function toggleChatTakeoverModal(){St(),i.a.dispatch(Object(H.d)({chatOpen:!0,isChatTakeover:!0}))},kt=function openChat(){St(),i.a.dispatch(Object(H.d)({chatOpen:!0}))},Ct=function hideChat(){i.a.dispatch(Object(H.d)({chatOpen:!1}))},yt=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return Se(),t.next=3,et(e);case 3:return t.next=5,Object(u.a)({topic:"reset-page-view"});case 5:return i.a.dispatch(Object(Ce.w)(Object(He.v)())),t.next=8,Ze();case 8:Object(De.a)();case 9:case"end":return t.stop()}},_callee2)}));return function page(t){return e.apply(this,arguments)}}(),Et=mt(function(){var e=Object(r.a)(c.a.mark(function _callee3(e){var t,n,a,r,o,u,l,d,b,f,p,h,O,g,v,j,m,_;return c.a.wrap(function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:if(a=null===(t=i.a.getState())||void 0===t?void 0:null===(n=t.conversations)||void 0===n?void 0:n.activeConversation,o=(r=e||{}).interactionId,u=r.goToConversation,l=void 0===u||u,d=r.replaceActiveConversation,b=void 0===d||d,f=r.hideChatIcon,p=void 0!==f&&f,h=Object(Re.e)(),O=!o||!Object(nt.a)(Number,o),g=!!a&&!b,!O&&!g){c.next=7;break}return c.abrupt("return");case 7:return c.next=9,Object(ct.a)();case 9:return i.a.dispatch(Object(H.d)({chatOpen:!1})),p&&i.a.dispatch(Object(H.b)(!0)),i.a.dispatch(Object(we.a)()),i.a.dispatch(Object(s.a)()),Object(U.g)(o),c.next=16,Object(ve.b)(o,{isTriggeredFromAPI:!0,locale:h,goToConversation:l});case 16:return v=c.sent,j=v.data,c.next=20,Object(ve.h)(j.conversationId);case 20:m=c.sent,_=m.data,i.a.dispatch(Object(we.h)({conversation:_})),i.a.dispatch(Object(we.n)({conversationId:j.conversationId}));case 24:case"end":return c.stop()}},_callee3)}));return function _startInteraction(t){return e.apply(this,arguments)}}()),It=function(){var e=Object(r.a)(c.a.mark(function _callee4(){var e,t,n,a,r,o,s=arguments;return c.a.wrap(function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:"",t=Object(Re.e)(),c.prev=2,c.next=5,Object(ve.d)(e,{isTriggeredFromAPI:!0,locale:t});case 5:return n=c.sent,a=n.data,c.next=9,Object(ve.h)(a.conversationId);case 9:r=c.sent,o=r.data,i.a.dispatch(Object(we.h)({conversation:o})),i.a.dispatch(Object(we.n)({conversationId:a.conversationId})),c.next=17;break;case 15:c.prev=15,c.t0=c.catch(2);case 17:case"end":return c.stop()}},_callee4,null,[[2,15]])}));return function goToNewConversation(){return e.apply(this,arguments)}}(),St=function show(){i.a.dispatch(Object(H.j)({matchedTargeting:!0})),Object(F.d)()},xt=function(){var e=Object(r.a)(c.a.mark(function _callee5(e,t){var n,a,r,o;return c.a.wrap(function _callee5$(c){for(;;)switch(c.prev=c.next){case 0:return n=Object(w.a)(null,["session","endUser","email"],i.a.getState()),a=Object(Re.e)(),kt(),c.prev=3,c.next=6,Object(ve.e)(n,e,a,t);case 6:r=c.sent,o=r.data.conversationId,i.a.dispatch(Object(we.n)({conversationId:o})),Object(D.i)(e),Object(Pe.d)(Fe.c.CALENDAR_DROP),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(3),Object(He.n)({data:[c.t0],type:"warn"});case 16:case"end":return c.stop()}},_callee5,null,[[3,13]])}));return function scheduleMeeting(t,n){return e.apply(this,arguments)}}(),At=function(){var e=Object(r.a)(c.a.mark(function _callee6(e){var t,n,a,r,o=arguments;return c.a.wrap(function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2&&void 0!==o[2]?o[2]:{},a=o.length>3&&void 0!==o[3]&&o[3],c.prev=3,c.next=6,Object(Me.c)(t,e,n);case 6:t.email&&(r=t.email,i.a.dispatch(Object(Ce.k)({endUser:{email:r}}))),a||Object(We.c)("OnReadyIdentify"),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(3),Object(He.n)({data:[c.t0],type:"warn"});case 13:case"end":return c.stop()}},_callee6,null,[[3,10]])}));return function identify(t){return e.apply(this,arguments)}}(),Tt=function(){var e=Object(r.a)(c.a.mark(function _callee7(e){var t,n,a;return c.a.wrap(function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:return t=i.a.getState(),n=t.session,a=n.externalId,c.next=4,Object(Me.c)(e,a);case 4:Object(D.r)();case 5:case"end":return c.stop()}},_callee7)}));return function setUserAttributes(t){return e.apply(this,arguments)}}(),Rt=mt(function(){var e=Object(r.a)(c.a.mark(function _callee8(e,t){var n,a,r,o,l,d,b,f,p,h,O,g,v,j,m,_,k,C,y,E,I;return c.a.wrap(function _callee8$(c){for(;;)switch(c.prev=c.next){case 0:return n=t&&"number"===typeof t.campaignId?t.campaignId:null,a=t&&"string"===typeof t.followupUrl?t.followupUrl:null,r=Object(Re.b)(n),o=i.a.getState(),l=Object(w.a)(null,["attributes","playbookId"],r),d=Object(w.a)(null,["session","endUser","id"],o),Object(Ne.a)("post_form_takeover_tti"),c.next=9,ze({campaignId:n,formData:e});case 9:if(b=c.sent,f=b.success,p=b.campaignMatched,f&&Object(We.c)("Form Data Submitted",{campaignId:n,playbookId:l,endUserId:d}),!p){c.next=35;break}if(Object(st.a)("post_form_takeover_enroll"),h=i.a.getState(),O=h.embed.id,g=h.session,v=g.campaignRefreshToken,j=g.context,m=g.geo,_=g.id,k=h.view,C=Object(Re.b)(n),y=Object(w.a)("",["page","url"],j),E=Object(w.a)(null,["attributes","playbookId"],C),!k.chatOpen){c.next=23;break}return Ct(),c.next=23,Object(He.q)(400);case 23:return i.a.dispatch(Object(we.a)()),i.a.dispatch(Object(s.a)()),Object(He.m)(a)||i.a.dispatch(Object(H.c)(t.followupUrl)),wt(),Object(Ne.a)("meeting_scheduler_rtt"),c.next=30,Object(_e.e)({campaignId:n,campaignRefreshToken:v,clientSideContext:{embedId:O,location:m,sessionId:_,pageUrl:y},playbookId:E,senderId:Object(Re.a)()});case 30:return(I=Object(st.b)("post_form_takeover_enroll"))&&Object(We.d)("Post Form Takeover Enroll",I),Object(Ne.a)("post_form_takeover_show"),Object(We.c)("Fast Lane Campaign Sent",{campaignId:n,playbookId:E,endUserId:d}),c.abrupt("return");case 35:if(Object(He.m)(a)){c.next=38;break}return c.next=38,Object(u.a)({topic:"redirect-to-url",message:{url:t.followupUrl}});case 38:case"end":return c.stop()}},_callee8)}));return function(t,n){return e.apply(this,arguments)}}(),15e3),Mt=function(){var e=Object(r.a)(c.a.mark(function _callee9(){var e,t,n,a,r,o,s,u,l;return c.a.wrap(function _callee9$(c){for(;;)switch(c.prev=c.next){case 0:return e=i.a.getState(),t=e.embed,n=t.id,a=Object(U.f)(),r=Object(De.b)(),c.next=6,Object(me.e)(Object(d.a)(Object(d.a)({embedId:n},r),{},{followingCampaignIds:a,excludedCampaignIds:[]}),!0);case 6:return o=c.sent,s=o.data,c.next=10,Object(Le.a)({conditions:s.campaignTargetingResults});case 10:u=c.sent,l=u.TAL,console.log("PLAYBOOK_TARGETING_RESULTS: ".concat(JSON.stringify(l,null,2)));case 13:case"end":return c.stop()}},_callee9)}));return function debugPlaybookTargeting(){return e.apply(this,arguments)}}(),Pt={identify:At,config:function config(e){if(!Object(nt.a)(Object,e))return!1;var t=function configOptionsToEmbedConfiguration(e){var t={theme:{}};if(Object(ut.a)(e))return t;var n=e.locale,a=e.enableWelcomeMessage,c=e.enableCampaigns,r=e.enableChatTargeting,o=e.enableSoundNotifications,i=e.backgroundColor,s=e.foregroundColor,u=e.activeColor,l=e.textColor,d=e.widgetBackgroundColor,b=e.autoAssigneeId,f=e.autoAssignee,p=e.inboxId,h=e.enabled,O=e.profileMode,g=e.messages,v=e.cookieDomain,j=e.verticalOffset,m=e.landingPageConfig,_=e.showDriftBranding,w=e.messageAttributes;return n&&(t.locale=n),Object(ut.a)(a)||(t.theme.showWelcomeMessage=!!a),Object(ut.a)(c)||(t.campaignsEnabled=c),!1===r&&(t.theme.audience=ne.a.EVERYONE,t.theme.conditions=[]),Object(ut.a)(o)||(t.theme.soundNotificationEnabled=o),i&&(t.theme.backgroundColor=i.replace("#","")),s&&(t.theme.foregroundColor=s.replace("#","")),u&&(t.theme.activeColor=u.replace("#","")),l&&(t.theme.textColor=l.replace("#","")),d&&(t.theme.widgetBackgroundColor=d.replace("#","")),Object(ut.a)(b)||(t.autoAssigneeId=b),Object(ut.a)(f)||(t.autoAssignee=f),p&&(t.inboxId=p),Object(ut.a)(j)||(t.verticalOffset=j),Object(ut.a)(h)||(t.enabled=!!h),Object(ut.a)(O)||(t.profileMode=!!O),Object(ut.a)(m)||(t.landingPageConfig=m),Object(ut.a)(_)||(t.showBranding=_),Object(ut.a)(w)||(t.messageAttributes=w),Object(ut.a)(g)||Object(lt.a)(function(e,n){g[n]&&(t.theme[e]=g[n])},dt),Object(ut.a)(v)||(t.theme.cookieDomains=[v]),t}(e);i.a.dispatch(function receiveEmbedConfigurationOverride(e){return Object(Ae.a)({type:"RECEIVE_EMBED_CONFIGURATION_OVERRIDE",payload:e})}(t))},track:function track(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{Object(je.a)(e,t)}catch(n){Object(He.w)(["Failed to send track event"+n])}},reset:_t,debug:function debug(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"playbooks":Mt()}},show:St,ping:function ping(){bt("drift.ping is not supported in this release.")},page:yt,hide:function hide(){Ct(),Object(F.a)()},off:function off(){},on:function on(){},collectFormData:Rt,goToConversation:function goToConversation(e){i.a.dispatch(Object(we.n)({conversationId:e})),kt()},goToConversationList:function goToConversationList(){var e=i.a.getState().conversations;Object(R.a)(e.conversations)||(kt(),i.a.dispatch(Object(H.h)({conversationHistoryOpen:!0})))},goToNewConversation:It,hideAwayMessage:function hideAwayMessage(){return Ct()},hideChat:Ct,hideWelcomeMessage:function hideWelcomeMessage(){return Ct()},openChat:kt,scheduleMeeting:xt,setUserAttributes:Tt,showAwayMessage:function showAwayMessage(e){i.a.dispatch(Object(H.j)({matchedHours:!1,matchedTargeting:!0})),i.a.dispatch(Object(we.a)()),i.a.dispatch(Object(s.a)()),e&&"string"===typeof e&&e.length&&i.a.dispatch(function receiveEmbedAwayMessage(e){return Object(Ae.a)({type:"RECIEVE_EMBED_AWAY_MESSAGE",payload:e})}({message:e})),Object(F.d)(),i.a.dispatch(Object(H.d)({chatOpen:!0,displayGreeting:!0}))},showWelcomeMessage:function showWelcomeMessage(e){i.a.dispatch(Object(H.j)({matchedHours:!0,matchedTargeting:!0})),i.a.dispatch(Object(we.a)()),i.a.dispatch(Object(s.a)()),e&&"string"===typeof e&&e.length&&i.a.dispatch(function receiveEmbedWelcomeMessage(e){return Object(Ae.a)({type:"RECEIVE_EMBED_WELCOME_MESSAGE",payload:e})}({message:e})),Object(F.d)(),i.a.dispatch(Object(H.d)({chatOpen:!0,displayGreeting:!0}))},showWelcomeOrAwayMessage:function showWelcomeOrAwayMessage(){i.a.dispatch(Object(we.a)()),kt()},startInteraction:Et,startVideoGreeting:function startVideoGreeting(){bt("drift.startVideoGreeting is not supported in this release.")},toggleChat:function toggleChat(){Object(w.a)(!1,["view","chatOpen"],i.a.getState())?Ct():kt()},toggleChatTakeoverModal:wt,evaluateCampaignTargeting:function evaluateCampaignTargeting(){Object(De.a)()},toggleHoursAndTargeting:function toggleHoursAndTargeting(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];i.a.dispatch(Object(H.j)({matchedHours:e,matchedTargeting:!0}))},waitForUserJwt:function waitForUserJwt(){try{i.a.dispatch(Object(Ce.x)())}catch(e){Object(He.n)({data:[e],type:"warn"})}},setUserJwt:function setUserJwt(e){try{i.a.dispatch(Object(Ce.o)(e))}catch(t){Object(He.n)({data:[t],type:"warn"})}}},Nt=new it,Lt=function handleApiEvent(e){var t=e.data,n=t.method,a=t.args;Pt[n]?jt(n,a)&&Nt.execute(function(){return Object(We.c)("API Event Fired",{method:n}),Pt[n].apply(Pt,Object(ge.a)(a))}):ft("".concat(n,"(...) does not exist."))},Dt=n("efbE"),Ut=n("LeJ0"),Bt=n("l+Xe"),Vt=function getDefaultAuthParams(e){return{org_id:e,client_id:Ut.a.CLIENT_ID,consent_id:"has_consent"}},Ft=function setVisitorPresenceApiBase(){var e="LOCAL"===Ut.a.WS_USER_ENV?"http":"https";Dt.t.defaults.baseURL="".concat(e,"://").concat(Ut.a.WS_VISITOR_PRESENCE_BASE,"/api")},Ht=function setChatApiBase(e){var t="LOCAL"===Ut.a.WS_USER_ENV?"http":"https";Dt.d.defaults.baseURL="".concat(t,"://").concat(Object(Bt.d)(e),"/api")},$t=function getAuthForChatSocket(e){return Dt.d.post("auth",e)},Wt=function getAuthForVisitorPresenceSocket(e){return Dt.t.post("auth",e)},Gt=function executeWidgetBootstrapForMode(e,t,n){switch(e){case"LANDING_PAGE":return Jt(t,n);case"CHAT":default:return qt(t,n)}},zt=function executeBootstrapPing(e){return Dt.c.post("widget_bootstrap/ping",e)},qt=function widgetBootstrap(e,t){var n=Vt(e);return Dt.b.post("widget_bootstrap",{data:Object(d.a)(Object(d.a)({},n),t)})},Jt=function landingPageBootstrap(e,t){var n=Vt(e);return Dt.b.post("widget_bootstrap/landing_page",{data:Object(d.a)(Object(d.a)({},n),t)})},Yt=n("yKvL"),Xt=n("LvsC"),Qt=n("qytN"),Kt=n("7jL2"),Zt=n("IpSJ"),en=function getEmbedConfiguration(e){return Dt.m.get("/embeds/".concat(e,".json"))},tn=["BE","BG","CZ","DK","DE","EE","IE","EL","ES","FR","HR","IT","CY","LV","LT","LU","HU","MT","NL","AT","PL","PT","RO","SI","SK","FI","SE","GB"],nn=["CA"],an={EU:tn,CANADA:nn,EU_CANADA:[].concat(nn,tn),NONE:"NONE",ALL:"ALL"},cn=n("+f1A"),rn=n("H/qh");!function(e){e.EU="EU",e.CANADA="CANADA",e.EU_CANADA="EU_CANADA",e.NONE="NONE",e.ALL="ALL"}(Je||(Je={}));var on=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t,n,a,r,o;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e=i.a.getState(),t=Object(ke.c)(e,"dataProtection",null),n=Object(cn.h)(e),a=Object(cn.c)(e),t){c.next=7;break}return un({needsConsent:!0,hasConsent:!1}),c.abrupt("return");case 7:r=sn(t.targeting,n),o=!r||a.hasConsent,un({needsConsent:r,hasConsent:o});case 10:case"end":return c.stop()}},_callee)}));return function checkGdprConsentEligibility(){return e.apply(this,arguments)}}(),sn=function resolveVisitorNeedsConsent(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).country;return e===an.ALL||!(e===an.NONE||!e)&&(!t||Object(rn.a)(t,an[e]))},un=function dispatchGdprEligbility(e){var t=e.needsConsent,n=e.hasConsent;i.a.dispatch(Object(Ce.p)({hasConsent:n,needsConsent:t}))},ln={googleAnalyticsSettings:!0},dn=function attachWidgetIntegrations(){var e=Object(ke.c)(i.a.getState(),"integrations",{});Object.keys(e).forEach(function(t){ln[t]&&Object(u.a)({topic:"handle-host-integration",message:{config:e[t],type:t}})})},bn=function receiveSentryConfig(e){return Object(Ae.a)({type:"RECEIVE_SENTRY_CONFIG",payload:e})},fn=n("pvgo"),pn=n("z8Kx"),hn=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t,n,a;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return e=i.a.getState(),t=e.session,n=e.conversations,a=Object(b.a)(["href"],t.context.page),c.abrupt("return",{engagement:{activeConversation:n.endUserEngaged},page:a,location:gn(t.geo),session:On(t.context,t.visitInformation)});case 3:case"end":return c.stop()}},_callee)}));return function generatePresenceContext(){return e.apply(this,arguments)}}(),On=function _hydrateSessionPresenceData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{numPageViews:Object(w.a)(0,["total"],t),numSessions:Object(w.a)(0,["total"],t),currentSessionStartedAt:e.currentSessionStartedAt,currentPageViewStartedAt:e.currentPageViewStartedAt,previousSessionStartedAt:Object(w.a)(null,["lastVisit"],t),previousSessionEndedAt:null,firstSessionAt:Object(w.a)(null,["firstVisit"],t),activeSessionStartedAt:e.activeSessionStartedAt}},gn=function _hydrateGeoPresenceData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ut.a)(e)?{}:{ip:e.ip,city:e.city,subdivision:e.subdivision,country:e.country,countryCode:e.countryCode,gdprApplicable:e.gdprApplicable,metroCode:e.metroCode,postalCode:e.postalCode,latLong:{lat:e.latitude,lon:e.longitude}}},vn=n("7VeV"),jn=n("Gzp1"),mn=function OpenSocket(e){var t=e.session_token,n=e.org_id,a=e.socketCluster,c=e.ip,r=Ut.a.WS_PROTOCOL,o="LOCAL"===Ut.a.WS_USER_ENV?"":"".concat(n,"-"),i=wn(n,o,a),s="".concat(r,"://").concat(i,"/ws"),u=new jn.Socket(s,{params:{session_token:t,remote_ip:c},timeout:1e4,reconnectAfterMs:function reconnectAfterMs(e){return[1e3,2e3,5e3,1e4][e-1]||1e4},rejoinAfterMs:function rejoinAfterMs(e){return[1e3,2e3,5e3][e-1]||1e4}});return u.connect(),u.onError(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object(He.n)({data:["Failed to connect to socket: ".concat(s)].concat(t)})}),u.onClose(function(){return Object(He.n)({data:["socket ".concat(s," has closed")]})}),u},_n=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,o;return c.a.wrap(function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:return t=e.channelName,n=e.socket,a=e.events,o=new Promise(function(){var e=Object(r.a)(c.a.mark(function _callee(e,r){var o;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:o=n.channel(t),a.forEach(function(e){var t=e.topic,n=e.event;o.on(t,n)}),o.join().receive("ok",function(){e({channel:o})}).receive("error",function(e){Object(He.n)({data:["Error connecting to channel: ".concat(t)]}),r(e)}).receive("timeout",function(e){Object(He.n)({data:["Joining the ".concat(t," channel timed out. ")]})});case 3:case"end":return c.stop()}},_callee)}));return function(t,n){return e.apply(this,arguments)}}()),i.abrupt("return",o);case 3:case"end":return i.stop()}},_callee2)}));return function JoinChannel(t){return e.apply(this,arguments)}}(),wn=function _resolveSocketBaseForType(e,t,n){switch(n){case zn.CHAT:return"".concat(Object(Bt.d)(e));case zn.USER:return Ut.a.WS_USER_BASE;case zn.PRESENCE:return"".concat(t).concat(Object(Bt.c)(e));case zn.VISITOR_PRESENCE:return Ut.a.WS_VISITOR_PRESENCE_BASE;default:return""}},kn=n("1tbh"),Cn=n("NFvl"),yn="emailCapture",En=n("0HCW"),In=n("y0Ar"),Sn=n("PjZB"),xn=n("3DW5"),An=n("7BJg");function _createSuper2(e){return function(){var t,n=Object(Kt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(Kt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(Qt.a)(this,t)}}var Tn=1e3,Rn=new(function(e){Object(Xt.a)(AgentMessageEventBuffer,e);var t=_createSuper2(AgentMessageEventBuffer);function AgentMessageEventBuffer(){var e;return Object(rt.a)(this,AgentMessageEventBuffer),(e=t.call(this,Tn))._publishBuffer=Object(r.a)(c.a.mark(function _callee(){return c.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(e._events.length){t.next=2;break}return t.abrupt("return");case 2:Object(T.n)(e._events).forEach(function(t){e._dispatchAgentMessage(t),i.a.dispatch(Object(we.s)({message:t}))}),e._resetBuffer();case 4:case"end":return t.stop()}},_callee)})),e._shouldPublishImmediately=function(e){return Object(T.i)(e)},e._openChatIfClosed=function(){i.a.getState().view.chatOpen||i.a.dispatch(Object(H.d)({chatOpen:!0}))},e._dispatchAgentMessage=function(e){i.a.dispatch(Object(we.c)({message:e}))},e}return AgentMessageEventBuffer}(An.a)),Mn=function evaluateBotChatMessage(e){if(Object(T.e)(e,"offerSchedule")||Object(T.e)(e,"presentSchedule")){var t=e.attributes.offerSchedule||e.attributes.presentSchedule;Object(D.i)(t),Object(Pe.d)(Fe.c.CALENDAR_DROP)}},Pn=n("BMKr"),Nn=function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a,r;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=Object(w.a)([],["attributes","conditionSetsToEvaluate"],e),n=Object(Cn.a)(["attributes","playbookId"],e),c.next=4,Object(Zt.a)(t);case 4:a=c.sent,r={requestingMessageId:e.id,conversationId:e.conversationId,targetingRequestPayload:a},Object(We.c)("conditional_evaluated",{playbookId:n,conditionalSkillPayload:r});try{Object(me.a)(r)}catch(o){Object(Pn.a)(new Error("Failed to evaluate conditional skill"))}case 8:case"end":return c.stop()}},_callee)}));return function evaluateConditionalMessage(t){return e.apply(this,arguments)}}(),Ln=function evaluateNewMessage(e){var t=Object(Cn.a)(["body","data"],e),n=i.a.getState();if(t){var a=Object(cn.d)(n),c=Object(T.a)(t,"instanceId"),r=Object(He.m)(c)||a===c;if(Object(T.e)(t,"widgetGuid")&&r)return function evaluateEndUserResponseChatMessage(e){if(Object(T.e)(e,"buttonClicked")&&Object(D.b)(e),e.body){var t=Object(xn.a)(e.body);t&&t.length&&t.forEach(function(t){Object(D.m)(e,t)})}}(t);var o=Object(En.c)(n),s=Object(En.d)(n),u=Object(T.e)(t,"startInteraction"),l=Object(T.e)(t,"liveViewInitiated"),b=Object(T.a)(t,"playbookId"),f=Object(T.a)(t,"campaignId"),p=Object(T.a)(t,"interactionId"),h=Object(T.a)(t,"isExperiment"),O=Object(T.a)(t,"playbookVersion"),g=t.conversationId,v=(o.includes(f)||s.includes(p))&&u,j=t.contentType===Sn.c.BOT_NODE_CONDITION_EVALUATION&&Object(T.e)(t,"conditionSetsToEvaluate"),m=Object(w.a)(!1,["contentType",Sn.c.CHAT],t)&&!t.body.length;if(v)Object(D.p)(t),Object(U.b)(t),i.a.dispatch(Object(we.n)({conversationId:g})),Object(In.a)({playbookId:b,interactionId:p,conversationId:g,isVirtual:!1,isExperiment:h,playbookVersion:O}),Object(T.a)(t,"goToConversation")&&(i.a.dispatch(Object(we.p)()),i.a.dispatch(Object(H.d)({chatOpen:!0})));return l?function evaluateLiveViewMessage(e){var t=e.id,n=void 0===t?null:t,a=e.conversationId,c=void 0===a?null:a;if(c&&n){var r=Object(d.a)(Object(d.a)({},e.attributes),{},{senderId:e.authorId}),o=Object(d.a)(Object(d.a)({},e),{},{attributes:r});Object(D.k)(e),i.a.dispatch(Object(we.n)({conversationId:c})),i.a.dispatch(Object(we.p)()),i.a.dispatch(Object(we.c)({message:o}))}}(t):j?Nn(t):Object(T.o)(t)?function evaluateChatMessage(e){var t=e.body.data;if(Rn.push(t),Object(D.k)(t),Object(T.e)(t,"isBot"))return Mn(t)}(e):void(m&&Object(B.d)(t.conversationId,t.id))}},Dn={topic:"data:sentMessage",event:function event(e){i.a.dispatch(Object(we.i)(e))}},Un={topic:"typing:started",event:function event(e){window.fallbackTimeout&&window.clearTimeout(window.fallbackTimeout),i.a.dispatch(Object(we.q)({conversationId:e.conversationId,userId:e.userId,isTyping:!0})),window.fallbackTimeout=window.setTimeout(function(){i.a.dispatch(Object(we.q)({conversationId:e.conversationId,userId:e.userId,isTyping:!1}))},5e3)}},Bn={topic:"typing:finished",event:function event(e){i.a.dispatch(Object(we.q)({conversationId:e.conversationId,isTyping:!1}))}},Vn=function sendRoundTripEventForLocalMessages(e){!!Object(Cn.a)(["body","data","attributes","widgetGuid"],e)&&e.body.data&&Object(kn.a)({message:e.body.data,timedOut:!1})},Fn=function(){var e=Object(r.a)(c.a.mark(function _callee(e){return c.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:Vn(e),"CREATE"===e.body.type&&"MESSAGE"===e.body.object.type&&Ln(e);case 3:case"end":return t.stop()}},_callee)}));return function onUserChangeEvent(t){return e.apply(this,arguments)}}(),Hn=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:t=e.body,n=t.type,a=t.data,n===yn&&i.a.dispatch(Object(Ce.d)({email:a.email}));case 2:case"end":return c.stop()}},_callee2)}));return function onUserTriggeredEvent(t){return e.apply(this,arguments)}}(),$n=[Dn],Wn=[Un,Bn,{topic:"change",event:Fn},{topic:"conversationPermaclose",event:function(){var e=Object(r.a)(c.a.mark(function _callee3(e){var t;return c.a.wrap(function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:t=e.conversationId,i.a.dispatch(Object(we.b)({conversationId:t}));case 2:case"end":return n.stop()}},_callee3)}));return function onUserPermacloseEvent(t){return e.apply(this,arguments)}}()},{topic:"event",event:Hn}],Gn=[],zn=Object.freeze({CHAT:"chat",USER:"user",PRESENCE:"presence",VISITOR_PRESENCE:"visitor_presence"}),qn=Object.freeze({CHAT:"chat",USER:"user",ORG_PUBLIC:"live",LIVE:"live"}),Jn=Object.freeze({CHAT:"chat",USER:"user",PRESENCE:"presence"}),Yn=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,o,i;return c.a.wrap(function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return t=e.session_token,n=e.org_id,a=e.socketCluster,o=e.ip,i=new Promise(function(){var e=Object(r.a)(c.a.mark(function _callee(e,r){var i;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,mn({session_token:t,org_id:n,socketCluster:a,ip:o});case 2:if(!(i=c.sent)){c.next=7;break}return c.abrupt("return",e(i));case 7:return c.abrupt("return",r("could not connect"));case 8:case"end":return c.stop()}},_callee)}));return function(t,n){return e.apply(this,arguments)}}()),s.abrupt("return",i);case 3:case"end":return s.stop()}},_callee2)}));return function connectToSocket(t){return e.apply(this,arguments)}}(),Xn=function(){var e=Object(r.a)(c.a.mark(function _callee3(e){var t,n,a,r,o,i;return c.a.wrap(function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.socket,n=e.socketAuth,a=e.channelEvents,r=e.channelName,o=e.orgId,c.prev=1,c.next=4,_n({channelName:Qn(r,n.user_id,o),socket:t,events:Kn(a)});case 4:return i=c.sent,c.abrupt("return",i);case 8:c.prev=8,c.t0=c.catch(1),Object(He.f)(new Error(c.t0));case 11:case"end":return c.stop()}},_callee3,null,[[1,8]])}));return function connectToChannel(t){return e.apply(this,arguments)}}(),Qn=function _resolveChannelName(e,t,n){switch(e){case qn.USER:case qn.CHAT:return"".concat(e,":").concat(t);case qn.LIVE:return"".concat(e,":").concat(n);default:return""}},Kn=function _resolveChannelEvents(e){switch(e){case Jn.CHAT:return $n;case Jn.USER:return Wn;case Jn.PRESENCE:return Gn;default:return[]}},Zn=5e3,ea=function(){function SocketManager(){Object(rt.a)(this,SocketManager),this._fireChannelConnectedEvent=function(e,t,n){i.a.dispatch(Object(Ce.g)(Object(d.a)({key:e,cluster:t},n)))}}return Object(ot.a)(SocketManager,[{key:"_fireSocketConnectedEvent",value:function _fireSocketConnectedEvent(e){i.a.dispatch(Object(Ce.u)({cluster:e}))}}]),SocketManager}();function chat_createSuper2(e){return function(){var t,n=Object(Kt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(Kt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(Qt.a)(this,t)}}var ta=new(function(e){Object(Xt.a)(ChatSocketManager,e);var t=chat_createSuper2(ChatSocketManager);function ChatSocketManager(){var e;return Object(rt.a)(this,ChatSocketManager),(e=t.call(this))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e._sendPresencePing=Object(r.a)(c.a.mark(function _callee(){var t,n;return c.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(e._channel){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,hn();case 4:t=a.sent,n=t.page,e._channel.channel.push("presence:send_update",{page:n});case 7:case"end":return a.stop()}},_callee)})),e.throttledPresencePing=Object(vn.throttle)(Zn,!1,e._sendPresencePing),e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(ot.a)(ChatSocketManager,[{key:"connect",value:function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,r=this;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.accessToken,n=e.orgId,Ht(n),c.next=4,Object(pn.a)({fn:$t,socketCluster:zn.CHAT,token:t});case 4:return a=c.sent,c.next=7,Yn({ip:a.remote_ip,org_id:n,session_token:a.session_token,socketCluster:zn.CHAT});case 7:return this._socket=c.sent,this._fireSocketConnectedEvent(zn.CHAT),c.next=11,Xn({socket:this._socket,channelEvents:Jn.USER,channelName:qn.USER,orgId:n,socketAuth:a});case 11:this._channel=c.sent,this._fireChannelConnectedEvent("user",zn.CHAT,this._channel),this._channel&&(this._sendPresencePing(),this._channel.channel.on("presence:request_update",function(){r.throttledPresencePing()}));case 14:case"end":return c.stop()}},_callee2,this)}));return function connect(t){return e.apply(this,arguments)}}()}]),ChatSocketManager}(ea));function visitorPresence_createSuper2(e){return function(){var t,n=Object(Kt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(Kt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(Qt.a)(this,t)}}var na=new(function(e){Object(Xt.a)(VisitorPresenceSocketManager,e);var t=visitorPresence_createSuper2(VisitorPresenceSocketManager);function VisitorPresenceSocketManager(){var e;return Object(rt.a)(this,VisitorPresenceSocketManager),(e=t.call(this))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(ot.a)(VisitorPresenceSocketManager,[{key:"connect",value:function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.orgId,n=e.accessToken,Ft(),c.next=4,Object(pn.a)({fn:Wt,socketCluster:zn.VISITOR_PRESENCE,token:n});case 4:return a=c.sent,c.next=7,Yn({ip:a.remote_ip,org_id:t,session_token:a.session_token,socketCluster:zn.VISITOR_PRESENCE});case 7:return this._socket=c.sent,this._fireSocketConnectedEvent(zn.VISITOR_PRESENCE),c.next=11,Xn({socket:this._socket,channelEvents:Jn.PRESENCE,channelName:qn.LIVE,orgId:t,socketAuth:a});case 11:this._channel=c.sent,this._fireChannelConnectedEvent("user",zn.VISITOR_PRESENCE,this._channel),this._channel&&(this._updatePresence(),this.startPresenceUpdateHeartbeat());case 14:case"end":return c.stop()}},_callee,this)}));return function connect(t){return e.apply(this,arguments)}}()},{key:"startPresenceUpdateHeartbeat",value:function startPresenceUpdateHeartbeat(){this._heartbeatInterval=window.setInterval(this._updatePresence.bind(this),6e4)}},{key:"_updatePresence",value:function(){var e=Object(r.a)(c.a.mark(function _callee2(){var e;return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:if(this._channel){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,hn();case 4:e=t.sent,this._channel.channel.push("heartbeat",e);case 6:case"end":return t.stop()}},_callee2,this)}));return function _updatePresence(){return e.apply(this,arguments)}}()},{key:"stopPresenceUpdateHeartbeat",value:function stopPresenceUpdateHeartbeat(){window.clearInterval(this._heartbeatInterval)}}]),VisitorPresenceSocketManager}(ea)),aa=function connectToWidgetSockets(e){var t=e.orgId,n=e.accessToken;try{ta.connect({accessToken:n,orgId:t}),$e("has_presence_disabled")||na.connect({accessToken:n,orgId:t})}catch(a){Object(He.f)(new Yt.a("Failed to connect to sockets - ".concat(a.message)))}},ca=n("EoDD"),ra=n("SWQ0"),oa=n("wNJw"),ia=function BootstrapBase(e){var t=this,n=e.embedId,a=e.params;Object(rt.a)(this,BootstrapBase),this._state=void 0,this._params=void 0,this._embedId=void 0,this._dispatch=void 0,this._instanceId=void 0,this._sessionId=void 0,this._orgId=void 0,this._identityMap=void 0,this._accessToken=void 0,this._currentPageUrl=void 0,this._bootstrapResponse=void 0,this._init=Object(r.a)(c.a.mark(function _callee(){var e,n,a;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,n=t._getSessionParamValueOrDefault("pageLoadStartTime",0),Object(fn.a)(n,t._instanceId),t._receiveSessionFromParams(),c.next=6,tt();case 6:return a=c.sent,t._currentPageUrl=null===(e=a.page)||void 0===e?void 0:e.href,c.next=10,t.beforeEmbedInitialized();case 10:return c.next=12,t._initializeFromEmbed();case 12:return c.next=14,t._handleServerBootstrap();case 14:return c.next=16,aa({orgId:t._orgId,accessToken:t._accessToken});case 16:return et(),on(),dn(),Object(fn.b)(),c.next=22,t.onBootstrapComplete();case 22:t._dispatch(Object(H.i)({initComplete:!0})),Object(We.a)("bootstrap.complete"),c.next=30;break;case 26:c.prev=26,c.t0=c.catch(0),c.t0 instanceof Yt.a&&(Object(oa.a)(ra.b.BOOTSTRAP_FAILED),Object(We.a)("bootstrap.failure")),Object(He.f)(c.t0);case 30:case"end":return c.stop()}},_callee,null,[[0,26]])})),this.onBootstrapComplete=function(){new Error("You must implement the onBootstrapComplete method in your extension of BootstrapBase")},this.onEmbedInitialized=function(){new Error("You must implement the onEmbedInitialized method in your extension of BootstrapBase")},this.beforeEmbedInitialized=function(){new Error("You must implement the beforeEmbedInitialized method in your extension of BootstrapBase")},this._initializeFromEmbed=Object(r.a)(c.a.mark(function _callee2(){return c.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._fetchEmbedFromCloudfront();case 2:return e.next=4,xe();case 4:return e.next=6,Se();case 6:return e.next=8,Ze();case 8:return e.next=10,t._generateAuthenticationIdentity();case 10:return e.next=12,t.onEmbedInitialized();case 12:case"end":return e.stop()}},_callee2)})),this._handleServerBootstrap=Object(r.a)(c.a.mark(function _callee4(){var e,n,a,o,i,u,l,d,f,p,h,O,g,v,j,m,_;return c.a.wrap(function _callee4$(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Object(st.c)(Object(r.a)(c.a.mark(function _callee3(){return c.a.wrap(function _callee3$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._getServerBootstrapResponse();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},_callee3)})),"widget_core:bootstrap_api");case 2:if(e=t._bootstrapResponse,n=e.tokenResult,a=e.location,o=void 0===a?{}:a,i=e.chatAuth,u=void 0===i?null:i,l=e.presenceAuth,d=void 0===l?null:l,f=e.sentryConfig,p=void 0===f?null:f,h=e.widgetChatBootstrapResponse,O=void 0===h?null:h,n){w.next=5;break}throw new Yt.a("Received null access token from widget auth");case 5:t._dispatch(Object(Ce.q)(o)),t._dispatch(Object(Ce.h)(u)),t._dispatch(Object(Ce.s)(d)),p&&t._dispatch(bn({forceLog:Object(ca.a)(t._orgId,p.allowListOrgIds),limit:p.limit})),O&&(Object(U.c)(O.campaignConversations),(g=Object.keys(O.campaignEnrollment)).length&&t._dispatch(Object(s.f)(g)),O.conversations.length&&t._dispatch(Object(we.f)({conversations:O.conversations}))),v=n.accessToken,j=n.didConsentToRequestedConsentId,m=n.assignedAgentId,t._accessToken=v,_=Object(b.a)(["didConsentToRequestedConsentId","accessToken","assignedAgentId"],n),t._dispatch(Object(Ce.k)({endUser:_,assignedAgentId:m})),t._dispatch(Object(Ce.f)({accessToken:v})),t._dispatch(Object(Ce.p)({hasConsent:j||!1}));case 16:case"end":return w.stop()}},_callee4)})),this._getServerBootstrapResponse=Object(r.a)(c.a.mark(function _callee5(){var e,n,a,r,o,i,s,u,l,b,f,p;return c.a.wrap(function _callee5$(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,e=t._state(),n=e.session,a=Object(w.a)("",["context","page","href"],n),r=Object(w.a)(0,["visitInformation","total"],n),o=n.campaignRefreshToken,i=t._orgId,s=Object(w.a)("CHAT",["mode"],t._params),u={sessionId:o,pageUrl:a,hasHadConversations:!1,followingCampaignIds:[],excludedCampaignIds:[],siteVisits:r},l=Object(d.a)(Object(d.a)({},t._identityMap),{},{embed_id:t._embedId,targeting_context:u}),c.next=11,Gt(s,i,l);case 11:b=c.sent,f=b.data,p=b.responseTime,t._bootstrapResponse=f,Object(We.d)("enduser_bootstrap",p),c.next=21;break;case 18:c.prev=18,c.t0=c.catch(0),Object(He.f)(new Yt.a("Failed to get bootstrap-api response - ".concat(c.t0.message)));case 21:case"end":return c.stop()}},_callee5,null,[[0,18]])})),this._receiveSessionFromParams=function(){t._dispatch(Object(Ce.t)({session:t._params.session}))},this._generateAuthenticationIdentity=Object(r.a)(c.a.mark(function _callee6(){var e,n,a;return c.a.wrap(function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:return e=t._state(),n=e.session,a=(void 0===n?{}:n).externalIdentity,c.next=4,Object(Me.a)();case 4:if(t._identityMap=c.sent,!a.externalId){c.next=8;break}return c.next=8,At(a.externalId,a.attributes,a.options,!0);case 8:case"end":return c.stop()}},_callee6)})),this._fetchEmbedFromCloudfront=Object(r.a)(c.a.mark(function _callee7(){var e,n,a,r,o;return c.a.wrap(function _callee7$(c){for(;;)switch(c.prev=c.next){case 0:return e={},c.prev=1,c.next=4,en(t._embedId);case 4:n=c.sent,a=n.data,r=n.responseTime,o=void 0===r?0:r,e=a,t._orgId=e.orgId,t._dispatch(Te(e)),Object(We.d)("Bootstrap.embed_fetch",o),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(1),Object(He.f)(new Yt.a("Embed Failed to load correctly - ".concat(c.t0.message)),c.t0);case 17:case"end":return c.stop()}},_callee7,null,[[1,14]])})),this._getSessionParamValueOrDefault=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return Object(w.a)(n,["session",e],t._params)},this._dispatch=i.a.dispatch,this._state=i.a.getState,this._embedId=n,this._params=a,this._sessionId=this._getSessionParamValueOrDefault("sessionId",null),this._instanceId=this._getSessionParamValueOrDefault("instanceId",null),this._init().catch(function(e){return Object(He.w)([e])})};function mode_chat_createSuper2(e){return function(){var t,n=Object(Kt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(Kt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(Qt.a)(this,t)}}var sa=function(e){Object(Xt.a)(ChatBootstrap,e);var t=mode_chat_createSuper2(ChatBootstrap);function ChatBootstrap(){var e;Object(rt.a)(this,ChatBootstrap);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).beforeEmbedInitialized=Object(r.a)(c.a.mark(function _callee(){var t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,da({embedId:e._embedId,pageUrl:e._currentPageUrl});case 2:t=n.sent,e._embedId=t.embedId;case 4:case"end":return n.stop()}},_callee)})),e.onBootstrapComplete=Object(r.a)(c.a.mark(function _callee2(){var t,n,a,r;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(Zt.c)();case 2:t=c.sent,n=e._bootstrapResponse.widgetChatBootstrapResponse,a=e._params.skipCampaigns||!1,r=n?Object(U.e)(n.campaignConversations):[],Object(De.a)({evaluatedConditionsResults:e._bootstrapResponse.evaluatedConditionsResults,unreadCampaignIds:r,skipCampaignTargeting:t||a});case 7:case"end":return c.stop()}},_callee2)})),e}return ChatBootstrap}(ia),ua=n("/VA8");function landingPage_createSuper2(e){return function(){var t,n=Object(Kt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(Kt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(Qt.a)(this,t)}}var la=function(e){Object(Xt.a)(LandingPageBootstrap,e);var t=landingPage_createSuper2(LandingPageBootstrap);function LandingPageBootstrap(){var e;Object(rt.a)(this,LandingPageBootstrap);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onBootstrapComplete=function(){Object(ua.a)()},e}return LandingPageBootstrap}(ia),da=function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n;return c.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,zt(e);case 3:return t=a.sent,n=t.data,a.abrupt("return",n);case 8:a.prev=8,a.t0=a.catch(0),Object(He.f)(new Yt.a("Failed to get ping information from bootstrap - ".concat(a.t0.message)),a.t0);case 11:case"end":return a.stop()}},_callee,null,[[0,8]])}));return function fetchPrerequisiteChatBootstrapData(t){return e.apply(this,arguments)}}(),ba=function init(e){switch(e.params.mode){case"LANDING_PAGE":return new la(e);case"CHAT":default:return new sa(e)}},fa=n("OA1u"),pa=n("uiOv"),ha=n("0LtH"),Oa=n("EQxi");n("z8n0");i.a.name="controller";t.default=Object(pa.a)(function WidgetControllerPage(e){var t=e.location,n=Object(k.useState)(!1),a=Object(o.a)(n,2),s=a[0],d=a[1],b=Object(Oa.f)(Ee.a.parse(t.search)),h=Object(He.v)();return Object(k.useEffect)(function(){if(s){var e=Object(st.b)("widget_core:widget_loaded");e&&(Object(We.d)("loaded",e),Object(We.a)("widget.v2.load",!1));var t=i.a.getState().embed,n=void 0===t?{}:t;return Object(se.a)(n),void Object(se.b)(n)}Object(p.a)({name:"controller",syncWith:"chat",store:i.a}),f(),l(),Object(u.c)({topic:"CONDUCTOR:send-usage-metric-event",handler:function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return t=e.data,n.next=3,Object(We.c)(t.name,t.attributes,t.publishImmediately);case 3:case"end":return n.stop()}},_callee)}));return function handler(t){return e.apply(this,arguments)}}()}),Object(u.c)({topic:"trigger-api-event",handler:Lt}),Object(u.c)({topic:"log-conductor-error",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;return Object(He.f)(new Error("WIDGET_CONDUCTOR: ".concat(n.message)))}}),Object(u.c)({topic:"get-ready-payload",handler:fn.c}),Object(u.c)({topic:"identity-provided-email",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;i.a.dispatch(Object(Ce.l)(n.email))}}),Object(u.c)({topic:"identity-provided",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;i.a.dispatch(Object(Ce.n)(n))}}),Object(u.c)({topic:"hide-widget-on-ready",handler:function handler(){i.a.dispatch(Object(fa.d)(!0))}}),Object(u.c)({topic:"show-widget-on-ready",handler:function handler(e){e.data,i.a.dispatch(Object(fa.b)(!0))}}),Object(u.c)({topic:"identity-provided-id",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;i.a.dispatch(Object(Ce.m)(n.externalId))}}),Object(u.c)({topic:"identity-provided-jwt",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;i.a.dispatch(Object(Ce.o)(n.userJwt))}}),Object(u.c)({topic:"host-hash-change",handler:function handler(e){var t=e.data;return Object(ha.a)(t.hash)}}),Object(u.c)({topic:"init-ready",handler:function(){var e=Object(r.a)(c.a.mark(function _callee2(){return c.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=!s,!e.t0){e.next=5;break}return e.next=5,ba({embedId:b.embedId,params:{skipCampaigns:b.skipCampaigns,forceShow:b.forceShow,session:{sessionId:b.sessionId,sessionStarted:b.sessionStarted,campaignRefreshToken:b.campaignRefreshToken,instanceId:h},mode:b.mode},timing:{pageLoadStartTime:b.pageLoadStartTime}});case 5:d(!0),e.next=11;break;case 8:e.prev=8,e.t1=e.catch(0),console.warn(e.t1);case 11:case"end":return e.stop()}},_callee2,null,[[0,8]])}));return function handler(){return e.apply(this,arguments)}}()}),Object(oa.a)(ra.b.API_READY)},[b.embedId,b.forceShow,b.skipCampaigns,s,b.sessionId,b.sessionStarted,b.campaignRefreshToken,h,b.pageLoadStartTime,b.mode]),C.a.createElement(P.a,{store:i.a},!b.hideController&&s&&C.a.createElement(Oe,null))})},Gxm1:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var a=n("QtlZ"),c=n("LVcX"),r=n("0lfv"),o=n("CYoe"),i=function markTime(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a.a.dispatch(Object(o.c)(e,t))},s=function measureTime(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),n=Object(c.a)(null,["metrics","timeByName",e],a.a.getState());return n?(a.a.dispatch(Object(o.a)(e)),t-n):(Object(r.n)({type:"warn",data:['Tried to measure "'.concat(e,'" without mark')]}),null)}},LwEI:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI"),r=n("vTYT");t.a=function useWidgetAlignment(){return Object(c.c)(function(e){return Object(a.a)(r.a.RIGHT,["embed","configuration","theme","alignment"],e)})}},My8U:function(e,t,n){"use strict";var a=n("nfbA"),c=n("SWQ0"),r=n("wNJw"),o=n("7oto");t.a=function UseStoreSync(e){var t=e.store,n=e.syncWith,i=e.name;return Object(o.c)({topic:"CONDUCTOR:action-from-".concat(n),handler:function handler(e){t.dispatch(Object(a.a)(Object(a.a)({},e.data.action),{},{_foreignDispatch:!0}))}}),Object(r.a)(c.a["".concat(i.toUpperCase(),"_READY")]),t}},NJR1:function(e,t,n){},"ab+K":function(e,t,n){"use strict";var a=n("nJ3u"),c=n("O94r"),r=n.n(c),o=n("/UYI"),i=n("nQD+"),s=n("z24s"),u=n("lE29"),l=n("LwEI"),d=n("ERkP"),b=n.n(d);n("NJR1");t.a=function MessageCloseButton(e){var t=e.onClick,n=Object(l.a)(),c=Object(u.a)(),f=Object(d.useRef)(null),p=Object(s.a)(f);return b.a.createElement(b.a.Fragment,null,b.a.createElement("style",null,".drift-widget-message-close-button.keyboard-focused {\n          opacity: 1;\n        }\n        .drift-widget-message-close-button.keyboard-focused:before {\n          ".concat(Object(a.a)(c.activeColor,20,-3,-3),"\n        }\n        ")),b.a.createElement(i.a,{onClick:function handleOnClick(e){(null===f||void 0===f?void 0:f.current)&&(null===f||void 0===f||f.current.blur()),t(e)},ref:f,className:r()("drift-widget-message-close-button","drift-widget-close-button--align-".concat(n),{"keyboard-focused":p}),"aria-label":"Close chat preview message overlay"},b.a.createElement(o.a,{width:10,height:10})))}},fL0f:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI");t.a=function useEmbedThemeProperties(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(c.c)(function(e){return Object(a.a)({},["embed","configuration","theme"],e)});return e.map(function(e){return t[e]})}},hSLT:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI");t.a=function useActiveAnnouncementCampaign(){var e=Object(c.c)(function(e){return Object(a.a)({},["campaigns","activeCampaign"],e)}),t=e.attributes,n=void 0===t?{}:t;return{id:e.id,playbookId:Object(a.a)(null,["playbookId"],n),ctaType:Object(a.a)(null,["cta","CtaType"],n),ctaCopy:Object(a.a)("",["cta","copy"],n),ctaUrl:Object(a.a)("",["cta","UrlLink"],n),body:n.message||"",title:n.title||"",thanksTitle:n.thankYouHeadline||"",thanksMessage:n.thankYouMessage||"",senderId:n.senderId,type:n.campaignDisplayType}}},nedb:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI"),r=function activeCampaignSelector(e){return Object(a.a)(null,["campaigns","activeCampaign"],e)};t.a=function useActiveCampaign(){return Object(c.c)(r)}},o3t1:function(e,t,n){"use strict";var a=n("s8DI"),c=n("ERkP"),r=n("0lfv"),o=n("6wvX");t.a=function useOnHover(){var e=Object(o.a)(),t=Object(c.useState)(!1),n=Object(a.a)(t,2),i=n[0],s=n[1];return Object(c.useMemo)(function(){return e?{}:{hoverProps:{onMouseOver:function onMouseOver(){return s(!0)},onMouseOut:function onMouseOut(){return s(!1)},onFocus:r.o,onBlur:r.o},isHovered:i}},[e,i])}},pUpc:function(e,t,n){},qATS:function(e,t,n){"use strict";var a=n("mj2O"),c=n.n(a),r=n("7SM1"),o=n("s8DI"),i=n("Hvhg"),s=n("2XY6"),u=n("ERkP"),l=n("uDfI"),d=n("0lfv"),b=n("VpmR");t.a=function useInitializeI18n(){var e=Object(u.useState)(!1),t=Object(o.a)(e,2),n=t[0],a=t[1],f=Object(l.c)(s.a),p=Object(l.c)(function(e){return Object(i.c)(e,"locale")});return Object(u.useEffect)(function(){f&&!n&&function(){var e=Object(r.a)(c.a.mark(function _callee(){return c.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(b.a)(p);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),Object(d.n)({data:["i18n failed to load - ".concat(e.t0.message),e.t0],type:"warn"});case 8:a(!0);case 9:case"end":return e.stop()}},_callee,null,[[0,5]])}));return function runAsync(){return e.apply(this,arguments)}}()()},[f,n,p]),n&&f}},tLIi:function(e,t,n){"use strict";var a=n("da4L"),c=n("LVcX"),r=n("i9gz"),o=n("TbSn"),i=n("uDfI");t.a=function useLastAgentMessage(){var e=Object(i.c)(function(e){return e.conversations}).activeConversation,t=Object(i.c)(function(t){return Object(c.a)(null,["conversations","conversations",e,"lastAgentMessage"],t)}),n=Object(i.c)(function(t){var n=Object(c.a)({},["conversations","messages",e],t);if(Object(r.a)(n))return{};var i=Object(a.p)(n).filter(function(e){return"USER"===Object(c.a)(null,["authorType"],e)});return i.length?Object(o.a)(i):void 0});return t||n||{}}},y0on:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("0lfv"),c=function getNewMessageAriaLabel(e,t){return Object(a.m)(t)?null:"Chat message".concat(e?" from "+e:"",': "').concat(t,'"')}},z8n0:function(e,t,n){}}]);